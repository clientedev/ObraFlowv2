BotÃ£o â€œReativar Obraâ€ (somente para usuÃ¡rios master)
ğŸ¯ Objetivo

Adicionar, dentro da tela de visualizaÃ§Ã£o de uma obra, um botÃ£o exclusivo para o usuÃ¡rio master que permita reativar uma obra concluÃ­da.

Se a obra estiver â€œConcluÃ­daâ€, exibe o botÃ£o â€œReativar Obraâ€.

Ao clicar, muda o status da obra para â€œAtivoâ€.

Atualiza automaticamente no banco de dados e redireciona o usuÃ¡rio para a pÃ¡gina da obra.

âš™ï¸ Etapa 1 â€” Backend (routes.py)

Procure a rota de visualizaÃ§Ã£o da obra (geralmente algo como /projects/<int:id>):

@app.route('/projects/<int:id>')
@login_required
def project_view(id):
    project = Project.query.get_or_404(id)
    return render_template('projects/view.html', project=project)


Logo abaixo dessa funÃ§Ã£o, adicione a nova rota de reativaÃ§Ã£o:

@app.route('/projects/<int:id>/reactivate', methods=['POST'])
@login_required
def reactivate_project(id):
    project = Project.query.get_or_404(id)

    # Permitir apenas usuÃ¡rio master
    if current_user.role != 'master':
        flash('Acesso negado. Apenas o usuÃ¡rio master pode reativar obras.', 'danger')
        return redirect(url_for('project_view', id=id))

    # Verifica status atual
    if project.status.lower() == 'concluÃ­do':
        project.status = 'Ativo'
        db.session.commit()
        flash('Obra reativada com sucesso!', 'success')
    else:
        flash('A obra jÃ¡ estÃ¡ ativa.', 'info')

    return redirect(url_for('project_view', id=id))

ğŸ§© Etapa 2 â€” Template (templates/projects/view.html)

Dentro da tela de visualizaÃ§Ã£o da obra, adicione o botÃ£o condicional.
Procure o local onde as informaÃ§Ãµes principais da obra sÃ£o exibidas e insira:

{% if current_user.role == 'master' %}
    {% if project.status.lower() == 'concluÃ­do' %}
        <form action="{{ url_for('reactivate_project', id=project.id) }}" method="POST" class="mt-3">
            <button type="submit" class="btn btn-warning">
                ğŸ”„ Reativar Obra
            </button>
        </form>
    {% endif %}
{% endif %}


ğŸ’¡ Dica:
Se quiser, adicione um alerta visual com o status atual da obra:

<span class="badge {{ 'bg-success' if project.status == 'Ativo' else 'bg-secondary' }}">
  {{ project.status }}
</span>

ğŸ§± Etapa 3 â€” Banco de Dados (models.py)

Certifique-se de que o modelo Project possui o campo status.
Se ainda nÃ£o existir, adicione:

status = db.Column(db.String(20), default='Ativo')


E depois rode a migraÃ§Ã£o no Replit (se estiver usando Alembic ou db.create_all).

ğŸ’… Etapa 4 â€” Estilo (opcional)

Para dar destaque ao botÃ£o no layout, adicione no CSS global:

.btn-warning {
  background-color: #f4b400;
  border: none;
  color: #fff;
  font-weight: 600;
}
.btn-warning:hover {
  background-color: #e39b00;
}

âœ… Resultado Final Esperado
CenÃ¡rio	Resultado
UsuÃ¡rio Master visualizando obra concluÃ­da	BotÃ£o â€œğŸ”„ Reativar Obraâ€ visÃ­vel
Ao clicar no botÃ£o	Status muda de â€œConcluÃ­doâ€ â†’ â€œAtivoâ€
Mensagem de sucesso	â€œObra reativada com sucesso!â€
UsuÃ¡rio comum	NÃ£o vÃª o botÃ£o
Obra jÃ¡ ativa	NÃ£o mostra botÃ£o
ğŸ§¾ Resumo TÃ©cnico
âœ” Adiciona rota /projects/<id>/reactivate com mÃ©todo POST
âœ” PermissÃ£o exclusiva para current_user.role == 'master'
âœ” Atualiza o campo status para â€œAtivoâ€ no banco de dados
âœ” Redireciona de volta Ã  tela de visualizaÃ§Ã£o
âœ” BotÃ£o visÃ­vel apenas se obra.status == â€œConcluÃ­doâ€
âœ” Feedback visual via flash messages