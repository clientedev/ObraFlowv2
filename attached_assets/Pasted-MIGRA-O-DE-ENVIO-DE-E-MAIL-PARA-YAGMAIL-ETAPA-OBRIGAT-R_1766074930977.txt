MIGRA√á√ÉO DE ENVIO DE E-MAIL PARA YAGMAIL
‚ö†Ô∏è ETAPA OBRIGAT√ìRIA INICIAL

Antes de qualquer implementa√ß√£o nova, REMOVA COMPLETAMENTE todas as APIs, servi√ßos, integra√ß√µes e l√≥gicas atuais de envio de e-mail existentes no sistema.

Apagar chamadas para APIs externas (SendGrid, Mailjet, SMTP customizado, etc.)

Remover servi√ßos auxiliares relacionados a e-mail

N√£o deixar c√≥digo legado, fallback ou l√≥gica paralela

N√£o alterar nenhuma outra funcionalidade do sistema

Essa remo√ß√£o deve ser isolada apenas ao envio de e-mails.

üéØ OBJETIVO DA NOVA IMPLEMENTA√á√ÉO

Implementar um envio de e-mail simples, direto e autom√°tico, utilizando exclusivamente a biblioteca yagmail, conectada a uma conta Google comum (Gmail).

N√£o ser√° utilizado:

API externa

Configura√ß√£o de dom√≠nio

DNS, SPF, DKIM

OAuth complexo

üìß CONTA DE ENVIO (FIXA)

O sistema deve utilizar sempre a seguinte conta Gmail para envio:

E-mail: relatorioselp@gmail.com

Senha: Relatorios#2025

‚ö†Ô∏è A autentica√ß√£o deve ser feita diretamente via yagmail.
‚ö†Ô∏è N√£o implementar fluxo de resposta (no-reply).

üîÅ GATILHO DE ENVIO

O envio de e-mail deve acontecer exclusivamente quando um relat√≥rio for APROVADO, independentemente do tipo:

Relat√≥rio Normal

Relat√≥rio Express

A aprova√ß√£o √© o √∫nico evento que dispara o envio.

üë• DESTINAT√ÅRIOS

Para cada aprova√ß√£o de relat√≥rio, enviar um e-mail individual para:

Pessoa que criou o relat√≥rio

Aprovador global

Todos os acompanhantes da visita vinculados ao relat√≥rio

‚ùó N√£o utilizar CC ou BCC
‚ùó Cada destinat√°rio recebe seu pr√≥prio e-mail

‚úâÔ∏è CONTE√öDO PADR√ÉO DO E-MAIL
Assunto:
Relat√≥rio aprovado ‚Äì Obra {NOME_DA_OBRA}

Corpo do e-mail (texto simples):
Ol√° {NOME_DO_DESTINAT√ÅRIO},

O relat√≥rio da obra "{NOME_DA_OBRA}" foi aprovado em {DATA_DA_APROVA√á√ÉO}.

Segue em anexo o arquivo PDF do relat√≥rio aprovado.

Este √© um e-mail autom√°tico.
Por favor, n√£o responda este e-mail.


üîπ Todas as vari√°veis devem ser preenchidas dinamicamente pelo sistema.

üìé ANEXO

Anexar obrigatoriamente o PDF oficial do relat√≥rio aprovado

O PDF deve ser o mesmo arquivo j√° gerado pelo sistema

Nome do arquivo deve ser claro e relacionado √† obra

‚öôÔ∏è REGRAS DE IMPLEMENTA√á√ÉO

Utilizar apenas yagmail

Criar uma camada √∫nica e centralizada de envio de e-mail

Garantir:

Um envio por destinat√°rio

Nenhum envio duplicado

Se um destinat√°rio n√£o possuir e-mail v√°lido:

Ignorar apenas aquele envio

N√£o interromper o fluxo geral

üö´ O QUE N√ÉO FAZER

N√£o reutilizar l√≥gica antiga

N√£o manter APIs antigas como fallback

N√£o alterar fluxo de aprova√ß√£o

N√£o criar novas telas

N√£o alterar gera√ß√£o de PDF

N√£o alterar regras de neg√≥cio existentes

‚úÖ RESULTADO ESPERADO

Ao final da implementa√ß√£o:

Todo relat√≥rio aprovado dispara corretamente o envio

Todos os envolvidos recebem e-mail personalizado

O PDF correto √© enviado em anexo

O sistema permanece est√°vel

N√£o existe nenhuma depend√™ncia de API externa