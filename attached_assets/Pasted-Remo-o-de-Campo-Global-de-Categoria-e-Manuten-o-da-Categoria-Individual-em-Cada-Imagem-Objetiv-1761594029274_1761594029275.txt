Remo√ß√£o de Campo Global de Categoria e Manuten√ß√£o da Categoria Individual em Cada Imagem
üéØ Objetivo

Remover o campo ‚ÄúCategoria padr√£o para novas fotos‚Äù da tela de relat√≥rios e garantir que a sele√ß√£o de categoria ocorra somente dentro do card individual de cada imagem. A categoria das imagens deve permitir valor nulo no banco de dados, mantendo compatibilidade com uploads antigos e sem causar erro no sistema. Quando n√£o houver categorias criadas, deve ser exibida a mensagem ‚ÄúAdicione uma categoria‚Äù e impedir o upload at√© que pelo menos uma categoria exista.

1Ô∏è‚É£ Escopo

Altera√ß√£o na tela de adi√ß√£o e edi√ß√£o de relat√≥rios.

Remover campo global de categoria padr√£o (frontend + backend).

Manter categoria opcional por imagem (permitindo NULL no banco).

Validar categoria apenas se categorias existirem no sistema.

2Ô∏è‚É£ Ajustes no Frontend
‚úÖ Remover:

Campo global:

Categoria padr√£o para novas fotos:
<select>...</select>


Vari√°veis associadas:

categoria_padrao_foto

categoria_predefinida_global

‚úÖ Manter:

Mensagem caso n√£o existam categorias:

{% if not categorias_predefinidas %}
<div class="alert alert-warning small mt-2">
  ‚ö†Ô∏è Nenhuma categoria cadastrada. Adicione categorias antes de anexar fotos.
</div>
{% endif %}


Campo individual em cada imagem:

<label class="form-label fw-semibold">Categoria</label>
<select name="imagens[{{ loop.index }}][categoria]" class="form-select">
    <option value="">Sem categoria</option>
    {% for categoria in categorias_predefinidas %}
    <option value="{{ categoria }}" {% if imagem.categoria == categoria %}selected{% endif %}>{{ categoria }}</option>
    {% endfor %}
</select>

3Ô∏è‚É£ Ajustes no Backend (Flask)

Permitir categoria = None no modelo FotoRelatorio.

Remover qualquer l√≥gica associada ao campo global:

# Remover linhas semelhantes a:
relatorio.categoria_padrao_foto = form.categoria_padrao.data


Manter carregamento das categorias:

categorias_predefinidas = db.session.query(CategoriaFoto).order_by(CategoriaFoto.nome).all()

4Ô∏è‚É£ Banco de Dados ‚Äì Ajuste üö®

Alterar a coluna categoria para permitir NULL:

ALTER TABLE fotos_relatorio ALTER COLUMN categoria DROP NOT NULL;


Criar migra√ß√£o Alembic correspondente.

5Ô∏è‚É£ Regras de Valida√ß√£o
Cen√°rio	A√ß√£o
Existem categorias no sistema	Usu√°rio pode escolher categoria ou deixar vazio
N√£o existem categorias	Impedir upload e exibir alerta
Upload antigo sem categoria	Deve continuar funcionando
6Ô∏è‚É£ Crit√©rios de Aceite ‚úÖ

‚úÖ Campo global removido
‚úÖ Sistema funcional mesmo com imagens sem categoria
‚úÖ Nenhum erro em relat√≥rios antigos
‚úÖ Categoria opcional no banco (NULL permitido)
‚úÖ UI limpa e funcional