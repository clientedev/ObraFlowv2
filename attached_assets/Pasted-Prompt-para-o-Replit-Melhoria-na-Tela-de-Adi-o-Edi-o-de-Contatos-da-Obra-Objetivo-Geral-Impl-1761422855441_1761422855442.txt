Prompt para o Replit â€” Melhoria na Tela de AdiÃ§Ã£o/EdiÃ§Ã£o de Contatos da Obra
ğŸ¯ Objetivo Geral

Implementar uma melhoria completa na tela de adiÃ§Ã£o e ediÃ§Ã£o de obras, especificamente na seÃ§Ã£o de contatos da obra, e aplicar uma padronizaÃ§Ã£o global de hierarquia entre contatos em todas as obras do sistema.

1ï¸âƒ£ Escopo da MudanÃ§a

A alteraÃ§Ã£o de layout e comportamento se aplica exclusivamente Ã  seÃ§Ã£o â€œContatos da Obraâ€ presente nas telas:

/projects/new â†’ Adicionar Obra

/projects/<id>/edit â†’ Editar Obra

E a mudanÃ§a hierÃ¡rquica vale globalmente, ou seja, todos os contatos de todas as obras passam a ter o mesmo nÃ­vel hierÃ¡rquico â€” nÃ£o existe mais o conceito de â€œContato Principalâ€.

2ï¸âƒ£ Melhorias de Layout (Frontend â€” HTML / Template / JS)
AtualizaÃ§Ã£o visual da seÃ§Ã£o â€œContatos da Obraâ€

Unificar o layout atual em um Ãºnico componente visual padronizado.

O novo bloco deve ser exibido com cards individuais para cada contato, organizados verticalmente.

Cada card conterÃ¡ os seguintes campos:

Nome  
Cargo  
Empresa  
E-mail  
Telefone (opcional)


Abaixo de cada card, incluir dois botÃµes:

âœï¸ Editar â†’ permite ediÃ§Ã£o inline dentro do card.

ğŸ—‘ï¸ Excluir â†’ remove o contato da lista (com confirmaÃ§Ã£o via modal).

Adicionar um botÃ£o global no final da lista:

+ Adicionar Contato â†’ insere um novo card vazio.

Exemplo visual esperado:
ğŸ‘¤ JoÃ£o Silva
Cargo: Engenheiro de Obra
Empresa: Construtora Alpha
E-mail: joao@alpha.com
Telefone: (11) 99999-9999

[âœï¸ Editar] [ğŸ—‘ï¸ Excluir]
---------------------------------
[+ Adicionar Contato]

3ï¸âƒ£ LÃ³gica de NegÃ³cio (Backend â€” Flask / SQLAlchemy)
Hierarquia Global

Remover qualquer lÃ³gica de diferenciaÃ§Ã£o entre contatos.

Todos os contatos devem ser tratados com o mesmo nÃ­vel de prioridade/hierarquia, sem campo â€œprincipalâ€.

Essa regra deve ser aplicada a todas as obras do sistema.

EdiÃ§Ã£o e exclusÃ£o

Permitir ediÃ§Ã£o inline diretamente na tela de adiÃ§Ã£o/ediÃ§Ã£o da obra.

Excluir contato com confirmaÃ§Ã£o modal.

AtualizaÃ§Ã£o deve refletir imediatamente no banco apÃ³s salvar a obra.

4ï¸âƒ£ Banco de Dados e Alembic
AlteraÃ§Ãµes na Estrutura

Confirmar nome da tabela associada a contatos da obra (provavelmente emails_clientes).

Caso exista campo de hierarquia como is_principal ou similar, remover via Alembic.

Garantir compatibilidade com os dados existentes (sem perda de registros).

Exemplo de migraÃ§Ã£o Alembic:
from alembic import op
import sqlalchemy as sa

revision = '20251026_0001'
down_revision = '20251024_1944'

def upgrade():
    with op.batch_alter_table('emails_clientes', schema=None) as batch_op:
        # Remover campo de hierarquia, se existir
        batch_op.drop_column('is_principal', if_exists=True)

def downgrade():
    with op.batch_alter_table('emails_clientes', schema=None) as batch_op:
        batch_op.add_column(sa.Column('is_principal', sa.Boolean(), nullable=True, default=False))

5ï¸âƒ£ Regras de ValidaÃ§Ã£o e ExibiÃ§Ã£o

âœ… Campos obrigatÃ³rios: Nome, Cargo, Empresa e E-mail.
âœ… Telefone Ã© opcional.
âœ… Todos os contatos de uma obra aparecem listados igualmente, sem destaque de hierarquia.
âœ… O layout estÃ¡ unificado e sem seÃ§Ãµes duplicadas.
âœ… EdiÃ§Ã£o inline e exclusÃ£o funcionam corretamente.
âœ… Ao salvar a obra, todos os contatos sÃ£o persistidos e exibidos na visualizaÃ§Ã£o da obra.
âœ… Ao visualizar qualquer obra, todos os contatos aparecem com o mesmo peso hierÃ¡rquico.

6ï¸âƒ£ CritÃ©rios de Aceite

A seÃ§Ã£o de contatos da obra na tela de adicionar/editar obra deve estar modernizada conforme o novo layout.

O sistema nÃ£o deve mais exibir ou processar â€œcontato principalâ€ em nenhum ponto.

O comportamento de listagem, ediÃ§Ã£o e exclusÃ£o deve ser idÃªntico entre obras novas e antigas.

A interface deve estar limpa, sem scrolls desnecessÃ¡rios ou seÃ§Ãµes redundantes.