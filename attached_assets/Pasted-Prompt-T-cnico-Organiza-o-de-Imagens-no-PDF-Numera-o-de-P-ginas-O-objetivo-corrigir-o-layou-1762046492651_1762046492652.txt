Prompt T√©cnico ‚Äî Organiza√ß√£o de Imagens no PDF + Numera√ß√£o de P√°ginas

O objetivo √© corrigir o layout e a renderiza√ß√£o das imagens no relat√≥rio em PDF, garantindo que todas sejam exibidas corretamente, mesmo quando h√° muitas fotos, e que o documento mantenha um padr√£o visual profissional.

üéØ Objetivo Geral

Garantir que as imagens sejam exibidas corretamente no PDF, com layout autom√°tico, proporcional e paginado, seguindo as seguintes regras:

‚úÖ Regras de Layout e Renderiza√ß√£o

Distribui√ß√£o das Imagens

As duas primeiras imagens (p√°gina 1) devem ocupar metade superior e inferior da p√°gina (duas por p√°gina).

A partir da terceira imagem, organizar o layout com at√© quatro imagens por p√°gina, em duas colunas e duas linhas.

Caso a quantidade de imagens n√£o seja m√∫ltiplo de 4, as imagens restantes devem ser centralizadas na √∫ltima p√°gina.

Propor√ß√£o das Imagens

As imagens devem manter sua propor√ß√£o original (aspect ratio), ajustando apenas a largura e altura dentro da √°rea dispon√≠vel.

Nenhuma imagem deve ser cortada, distorcida ou sobreposta.

Margens e Espa√ßamento

Inserir uma margem de 20px em todas as bordas da p√°gina.

Espa√ßamento de 10px entre imagens, garantindo separa√ß√£o visual limpa.

Numera√ß√£o das P√°ginas

Adicionar no canto inferior direito de todas as p√°ginas o texto no formato:

P√°gina X / Y


onde:

X = n√∫mero da p√°gina atual

Y = total de p√°ginas do documento

O texto deve ter tamanho de fonte pequeno (‚âà 9pt) e cor cinza escura (#666), alinhado √† margem inferior direita.

Compatibilidade

O layout deve funcionar corretamente para qualquer quantidade de imagens (de 1 at√© 200).

A renderiza√ß√£o deve ser est√°vel tanto em dispositivos m√≥veis quanto desktop.

O c√≥digo deve suportar reportlab (Python) ou pdfkit/wkhtmltopdf (HTML ‚Üí PDF), conforme o sistema atual.

‚öôÔ∏è Implementa√ß√£o Sugerida (ReportLab - Python)
from reportlab.platypus import SimpleDocTemplate, Image, PageBreak, Spacer
from reportlab.lib.pagesizes import A4
from reportlab.lib.units import cm
from reportlab.pdfgen import canvas
import math

def add_page_number(canvas, doc):
    page_num = canvas.getPageNumber()
    total_pages = doc.page_count
    text = f"{page_num}/{total_pages}"
    canvas.setFont("Helvetica", 9)
    canvas.setFillColorRGB(0.4, 0.4, 0.4)
    canvas.drawRightString(20.0 * cm, 1.0 * cm, text)

def gerar_pdf_imagens(caminhos_imagens, nome_arquivo="relatorio.pdf"):
    pdf = SimpleDocTemplate(nome_arquivo, pagesize=A4)
    largura, altura = A4
    elementos = []

    # Primeiras duas imagens ‚Äî 2 por p√°gina
    for i, img_path in enumerate(caminhos_imagens[:2]):
        elementos.append(Image(img_path, width=largura - 40, height=(altura/2) - 60, preserveAspectRatio=True))
        elementos.append(Spacer(1, 10))
    elementos.append(PageBreak())

    # Restantes ‚Äî 4 por p√°gina
    imagens_restantes = caminhos_imagens[2:]
    for i, img_path in enumerate(imagens_restantes):
        elementos.append(Image(img_path, width=(largura/2) - 40, height=(altura/2) - 60, preserveAspectRatio=True))
        if (i + 1) % 4 == 0:
            elementos.append(PageBreak())

    # Contagem total de p√°ginas
    total_paginas = math.ceil(len(caminhos_imagens[:2]) / 2) + math.ceil(len(imagens_restantes) / 4)
    pdf.page_count = total_paginas

    pdf.build(elementos, onLaterPages=add_page_number, onFirstPage=add_page_number)

gerar_pdf_imagens(["img1.jpg", "img2.jpg", "img3.jpg", "img4.jpg", "img5.jpg"])

üß™ Crit√©rios de Aceita√ß√£o

‚úÖ Todas as imagens s√£o exibidas corretamente (sem corte nem distor√ß√£o).

‚úÖ Layout segue a estrutura: 2 imagens na 1¬™ p√°gina, 4 imagens nas demais.

‚úÖ Pagina√ß√£o correta (‚Äú1/5‚Äù, ‚Äú2/5‚Äù, etc.) no canto inferior direito.

‚úÖ Arquivo PDF visualmente limpo, organizado e compat√≠vel com visualiza√ß√£o mobile e desktop.