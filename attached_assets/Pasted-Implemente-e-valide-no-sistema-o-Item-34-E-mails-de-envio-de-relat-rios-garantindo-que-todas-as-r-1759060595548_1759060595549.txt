Implemente e valide no sistema o Item 34 ‚Äì E-mails de envio de relat√≥rios, garantindo que todas as rotas, templates e integra√ß√µes estejam 100% funcionais em produ√ß√£o (Railway/PostgreSQL).

‚úÖ Requisitos j√° atendidos:

Rotas completas para CRUD de configura√ß√µes de e-mail:

/admin/configuracao-email ‚Üí lista todas as configs

/admin/configuracao-email/nova ‚Üí criar nova config global

/admin/configuracao-email/{id}/editar ‚Üí editar config existente

/admin/configuracao-email/{id}/ativar ‚Üí ativar/desativar config

/admin/configuracao-email/{id}/testar ‚Üí testar conectividade SMTP

/admin/user-email-configs ‚Üí configs individuais por usu√°rio

Sistema de configura√ß√£o por usu√°rio (UserEmailConfig)

Templates HTML funcionais no padr√£o do sistema

Valida√ß√µes completas e tratamento de erros no formul√°rio

Teste de configura√ß√µes com SMTP antes de salvar

Sistema de ativa√ß√£o/desativa√ß√£o de configs

üéØ O que precisa ser garantido:

Integra√ß√£o com envio de relat√≥rios:

Se usu√°rio possui configura√ß√£o pr√≥pria ativa ‚Üí usar essa conta SMTP.

Caso contr√°rio ‚Üí fallback para configura√ß√£o global (configuracao_email).

Sempre enviar c√≥pia autom√°tica (CC) para aprovador/preenchedor envolvido.

Compatibilidade com o sistema existente:

Deve usar email_service.py existente.

Modelos ConfiguracaoEmail e UserEmailConfig funcionando com SQLAlchemy.

Registro de logs em log_envio_emails informando qual conta foi usada.

Tela de Administra√ß√£o:

Apenas administradores podem acessar as rotas /admin/configuracao-email e /admin/user-email-configs.

Interface responsiva no mesmo padr√£o visual do sistema.

Mostrar status (ativa/inativa/testada com sucesso).

Banco de Dados (Alembic Migration):

Garantir que a tabela user_email_config j√° exista e seja atualizada se necess√°rio.

Se n√£o existir ‚Üí criar com os campos:

id, user_id, smtp_server, smtp_port, email_address, email_password, use_tls, use_ssl, is_active, created_at, updated_at.

‚ö° Resultado esperado:

Usu√°rio Isadora preenche relat√≥rio ‚Üí envio pelo e-mail dela.

Usu√°rio Leopoldo aprova relat√≥rio ‚Üí envio pelo e-mail dele.

Sistema Luciana recebe c√≥pia (CC).

Se usu√°rio n√£o tem configura√ß√£o ‚Üí envio pelo e-mail global configurado.

Admin consegue gerenciar, ativar, editar e testar e-mails de qualquer usu√°rio.